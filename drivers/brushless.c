#include <avr32/io.h>
#include "brushless.h"

static uint16_t SPEED_LUT[256] = {
    17637,17693,17749,17805,17861,17917,17973,18029,
    18085,18141,18197,18253,18309,18365,18421,18477,
    18533,18589,18645,18701,18757,18813,18869,18925,
    18981,19037,19093,19149,19205,19261,19317,19373,
    19429,19485,19541,19597,19653,19709,19765,19821,
    19877,19933,19989,20045,20101,20157,20213,20269,
    20325,20381,20437,20493,20549,20605,20661,20717,
    20773,20829,20885,20941,20997,21053,21109,21165,
    21221,21277,21333,21389,21445,21501,21557,21613,
    21669,21725,21781,21837,21893,21949,22005,22061,
    22117,22173,22229,22285,22341,22397,22453,22509,
    22565,22621,22677,22733,22789,22845,22901,22957,
    23013,23069,23125,23181,23237,23293,23349,23405,
    23461,23517,23573,23629,23685,23741,23797,23853,
    23909,23965,24021,24077,24133,24189,24245,24301,
    24357,24413,24469,24525,24581,24637,24693,24749,
    24805,24861,24917,24973,25029,25085,25141,25197,
    25253,25309,25365,25421,25477,25533,25589,25645,
    25701,25757,25813,25869,25925,25981,26037,26093,
    26149,26205,26261,26317,26373,26429,26485,26541,
    26597,26653,26709,26765,26821,26877,26933,26989,
    27045,27101,27157,27213,27269,27325,27381,27437,
    27493,27549,27605,27661,27717,27773,27829,27885,
    27941,27997,28053,28109,28165,28221,28277,28333,
    28389,28445,28501,28557,28613,28669,28725,28781,
    28837,28893,28949,29005,29061,29117,29173,29229,
    29285,29341,29397,29453,29509,29565,29621,29677,
    29733,29789,29845,29901,29957,30013,30069,30125,
    30181,30237,30293,30349,30405,30461,30517,30573,
    30629,30685,30741,30797,30853,30909,30965,31021,
    31077,31133,31189,31245,31301,31357,31413,31469,
    31525,31581,31637,31693,31749,31805,31861,31917
};

void brushless_set_speed(uint8_t speed){
    AVR32_PWM.channel[0].cdty = SPEED_LUT[speed];
}
